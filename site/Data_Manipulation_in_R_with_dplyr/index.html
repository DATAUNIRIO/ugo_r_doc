<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Ugo Sparks">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Data Manipulation in R with dplyr - ugo_r_doc</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Manipulation in R with dplyr";
    var mkdocs_page_input_path = "Data_Manipulation_in_R_with_dplyr.md";
    var mkdocs_page_url = "/Data_Manipulation_in_R_with_dplyr/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-93008985-1', 'mkdocs.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> ugo_r_doc</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../An Introduction to R/">An Introduction to R</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques/">Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../R_CS/">R Cheat Sheets</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Intermediate R</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Intermediate_R/">Intermediate R</a>
                </li>
                <li class="">
                    
    <a class="" href="../Intermediate_R_-_The_apply_Family/">Intermediate R - The apply Family</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">RStudio</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Code___Plot_Chunk_Options/">Code & Plot Chunk Options</a>
                </li>
                <li class="">
                    
    <a class="" href="../Working_with_RStudio_IDE/">Working with the RStudio IDE</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Data Wrangling Snippets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../IO_snippets___Cleaning/">I/O snippets & Cleaning</a>
                </li>
                <li class="">
                    
    <a class="" href="../Reading_Data_into_R_with_readr/">Reading Data into R with readr</a>
                </li>
                <li class="">
                    
    <a class="" href="../Data_Analysis_in_R,_the_data.table_Way/">Data Analysis in R, the data.table Way</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Data Manipulation in R with dplyr</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#1-introduction-to-dplyr">1, Introduction to dplyr</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#load-the-dplyr-and-hflights-package">Load the dplyr and hflights package</a></li>
        
            <li><a class="toctree-l4" href="#convert-dataframe-to-table">Convert data.frame to table</a></li>
        
            <li><a class="toctree-l4" href="#changing-labels-of-hflights">Changing labels of hflights</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#2-select-and-mutate">2, select and mutate</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#the-five-verbs-and-their-meaning">The five verbs and their meaning</a></li>
        
            <li><a class="toctree-l4" href="#the-select-verb">The select verb</a></li>
        
            <li><a class="toctree-l4" href="#helper-functions-for-variable-selection">Helper functions for variable selection</a></li>
        
            <li><a class="toctree-l4" href="#comparison-to-basic-r">Comparison to basic R</a></li>
        
            <li><a class="toctree-l4" href="#mutate-is-creating">mutate is creating</a></li>
        
            <li><a class="toctree-l4" href="#add-multiple-variables-using-mutate">Add multiple variables using mutate</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#3-filter-and-arrange">3, filter and arrange</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#logical-operators">Logical operators</a></li>
        
            <li><a class="toctree-l4" href="#combining-tests-using-boolean-operators">Combining tests using boolean operators</a></li>
        
            <li><a class="toctree-l4" href="#blend-together">Blend together</a></li>
        
            <li><a class="toctree-l4" href="#arranging-your-data">Arranging your data</a></li>
        
            <li><a class="toctree-l4" href="#reverse-the-order-of-arranging">Reverse the order of arranging</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#4-summarise-and-the-pipe-operator">4, summarise and the Pipe Operator</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#the-syntax-of-summarise">The syntax of summarise</a></li>
        
            <li><a class="toctree-l4" href="#aggregate-functions">Aggregate functions</a></li>
        
            <li><a class="toctree-l4" href="#dplyr-aggregate-functions">dplyr aggregate functions</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#5-group_by-and-working-with-data">5, group_by and working with data</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#unite-and-conquer-using-group_by">Unite and conquer using group_by</a></li>
        
            <li><a class="toctree-l4" href="#combine-group_by-with-mutate">Combine group_by with mutate</a></li>
        
            <li><a class="toctree-l4" href="#advanced-group_by">Advanced group_by</a></li>
        
            <li><a class="toctree-l4" href="#dplyr-deals-with-different-types">dplyr deals with different types</a></li>
        
            <li><a class="toctree-l4" href="#dplyr-and-mysql-databases">dplyr and mySQL databases</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#adding-tidyr-functions">Adding tidyr Functions</a></li>
    

    <li class="toctree-l3"><a href="#joining-data-in-r-with-dplyr">Joining Data in R with dplyr</a></li>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plot Snippets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_Basics/">Plot Snippets for Exploratory (and some Explanatory) Analyses</a>
                </li>
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_ggplot2/">Plot Snippets - ggplot2</a>
                </li>
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_ggvis/">Plot Snippets - ggvis</a>
                </li>
                <li class="">
                    
    <a class="" href="../Plot_snippets_-_Colours/">Plot Snippets - Colours</a>
                </li>
                <li class="">
                    
    <a class="" href="../googleVis/">googleVis (embed HTML plots)</a>
                </li>
                <li class="">
                    
    <a class="" href="../gganimate/">gganimate</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Other Snippets</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../Tables/">Tables</a>
                </li>
                <li class="">
                    
    <a class="" href="../embedding/">Embedding HTML into HTML</a>
                </li>
                <li class="">
                    
    <a class="" href="../embedding2/">Embedding Rmd into Rmd</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">A Hands-on Introduction to Statistics with R</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_One,_Introduction/">Statistics with R, Course One, Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Two,_Student_s_T-test/">Statistics with R, Course Two, Student's t-test</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Three,_Analysis_of_Variance/">Statistics with R, Course Three, Analysis of Variance</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Four,_Repeated_Measures_Anova/">Statistics with R, Course Four, Repeated Measures ANOVA</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Five,_Correlation_and_Regression/">Statistics with R, Course Five, Correlation and Regression</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Six,_Multiple_Regression/">Statistics with R, Course Six, Multiple Regression</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Seven,_Moderation_and_Mediation/">Statistics with R, Course Seven, Moderation and Mediation</a>
                </li>
                <li class="">
                    
    <a class="" href="../A_Hands-on_Introduction_to_Statistics_with_R,_Notes/">Statistics with R, Notes</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Big_Data_Analysis_with_Revolution_R_Enterprise/">Big Data Analysis with Revolution R Enterprise</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Time+Series+in+R+The+Power+of+xts+and+zoo/">Time Series in R, The Power of xts and zoo</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">ugo_r_doc</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Data Wrangling Snippets &raquo;</li>
        
      
    
    <li>Data Manipulation in R with dplyr</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <ul>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#introduction-to-dplyr">1, Introduction to <code>dplyr</code></a><ul>
<li><a href="#load-the-dplyr-and-hflights-package">Load the <code>dplyr</code> and <code>hflights</code><br />
    package</a></li>
<li><a href="#convert-data.frame-to-table">Convert <code>data.frame</code> to table</a></li>
<li><a href="#changing-labels-of-hflights">Changing labels of <code>hflights</code></a></li>
</ul>
</li>
<li><a href="#select-and-mutate">2, <code>select</code> and <code>mutate</code></a><ul>
<li><a href="#the-five-verbs-and-their-meaning">The five verbs and their<br />
    meaning</a></li>
<li><a href="#the-select-verb">The <code>select</code> verb</a></li>
<li><a href="#helper-functions-for-variable-selection">Helper functions for variable<br />
    selection</a></li>
<li><a href="#comparison-to-basic-r">Comparison to basic R</a></li>
<li><a href="#mutate-is-creating"><code>mutate</code> is creating</a></li>
<li><a href="#add-multiple-variables-using-mutate">Add multiple variables using<br />
<code>mutate</code></a></li>
</ul>
</li>
<li><a href="#filter-and-arrange">3, <code>filter</code> and <code>arrange</code></a><ul>
<li><a href="#logical-operators">Logical operators</a></li>
<li><a href="#combining-tests-using-boolean-operators">Combining tests using boolean<br />
    operators</a></li>
<li><a href="#blend-together">Blend together</a></li>
<li><a href="#arranging-your-data">Arranging your data</a></li>
<li><a href="#reverse-the-order-of-arranging">Reverse the order of<br />
    arranging</a></li>
</ul>
</li>
<li><a href="#summarise-and-the-pipe-operator">4, <code>summarise</code> and the Pipe<br />
    Operator</a><ul>
<li><a href="#the-syntax-of-summarise">The syntax of <code>summarise</code></a></li>
<li><a href="#aggregate-functions">Aggregate functions</a></li>
<li><a href="#dplyr-aggregate-functions"><code>dplyr</code> aggregate functions</a></li>
</ul>
</li>
<li><a href="#group_by-and-working-with-data">5, <code>group_by</code> and working with<br />
    data</a><ul>
<li><a href="#unite-and-conquer-using-group_by">Unite and conquer using<br />
<code>group_by</code></a></li>
<li><a href="#combine-group_by-with-mutate">Combine <code>group_by</code> with<br />
<code>mutate</code></a></li>
<li><a href="#advanced-group_by">Advanced <code>group_by</code></a></li>
<li><a href="#dplyr-deals-with-different-types"><code>dplyr</code> deals with different<br />
    types</a></li>
<li><a href="#dplyr-and-mysql-databases"><code>dplyr</code> and mySQL databases</a></li>
</ul>
</li>
<li><a href="#adding-tidyr-functions">Adding <code>tidyr</code> Functions</a></li>
<li><a href="#joining-data-in-r-with-dplyr">Joining Data in R with <code>dplyr</code></a></li>
</ul>
<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Output options: the &lsquo;tango&rsquo; syntax and the &lsquo;readable&rsquo; theme.</li>
<li>Snippets and results.</li>
</ul>
<hr />
<h4 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h4>
<p><code>data.table</code></p>
<ul>
<li>extension of <code>data.frame</code>.</li>
<li>Fast aggregation of large data (e.g. 100GB in RAM), fast ordered<br />
    joins, fast add/modify/delete of columns by group using no copies at<br />
    all, list columns, a fast friendly file reader and parallel<br />
    file writer. Offers a natural and flexible syntax, for<br />
    faster development.</li>
</ul>
<p><code>dplyr</code></p>
<ul>
<li>A fast, consistent tool for working with data frame like objects,<br />
    both in memory and out of memory.</li>
<li>Pipelines.</li>
</ul>
<p><code>tidyr</code></p>
<ul>
<li>An evolution of &lsquo;reshape2&rsquo;. It&rsquo;s designed specifically for data<br />
    tidying (not general reshaping or aggregating) and works well with<br />
    dplyr data pipelines.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">package</th>
<th align="left">'narrower'</th>
<th align="left">'wider'</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyr</code></td>
<td align="left">gather</td>
<td align="left">spread</td>
</tr>
<tr class="even">
<td align="left"><code>reshape2</code></td>
<td align="left">melt</td>
<td align="left">cast</td>
</tr>
<tr class="odd">
<td align="left">spreadsheets</td>
<td align="left">unpivot</td>
<td align="left">pivot</td>
</tr>
<tr class="even">
<td align="left">databases</td>
<td align="left">fold</td>
<td align="left">unfold</td>
</tr>
</tbody>
</table>

<h4 id="1-introduction-to-dplyr">1, Introduction to <code>dplyr</code><a class="headerlink" href="#1-introduction-to-dplyr" title="Permanent link">&para;</a></h4>
<h5 id="load-the-dplyr-and-hflights-package">Load the <code>dplyr</code> and <code>hflights</code> package<a class="headerlink" href="#load-the-dplyr-and-hflights-package" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Load the dplyr package
library(dplyr)
library(dtplyr)

# Load the hflights package
# A data only package containing commercial domestic flights that departed Houston (IAH and HOU) in 2011
library(hflights)

# Call both head() and summary() on hflights
head(hflights)
</code></pre>

<pre><code>##      Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
## 5424 2011     1          1         6    1400    1500            AA
## 5425 2011     1          2         7    1401    1501            AA
## 5426 2011     1          3         1    1352    1502            AA
## 5427 2011     1          4         2    1403    1513            AA
## 5428 2011     1          5         3    1405    1507            AA
## 5429 2011     1          6         4    1359    1503            AA
##      FlightNum TailNum ActualElapsedTime AirTime ArrDelay DepDelay Origin
## 5424       428  N576AA                60      40      -10        0    IAH
## 5425       428  N557AA                60      45       -9        1    IAH
## 5426       428  N541AA                70      48       -8       -8    IAH
## 5427       428  N403AA                70      39        3        3    IAH
## 5428       428  N492AA                62      44       -3        5    IAH
## 5429       428  N262AA                64      45       -7       -1    IAH
##      Dest Distance TaxiIn TaxiOut Cancelled CancellationCode Diverted
## 5424  DFW      224      7      13         0                         0
## 5425  DFW      224      6       9         0                         0
## 5426  DFW      224      5      17         0                         0
## 5427  DFW      224      9      22         0                         0
## 5428  DFW      224      9       9         0                         0
## 5429  DFW      224      6      13         0                         0
</code></pre>
<pre><code class="r">summary(hflights)
</code></pre>

<pre><code>##       Year          Month          DayofMonth      DayOfWeek    
##  Min.   :2011   Min.   : 1.000   Min.   : 1.00   Min.   :1.000  
##  1st Qu.:2011   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.:2.000  
##  Median :2011   Median : 7.000   Median :16.00   Median :4.000  
##  Mean   :2011   Mean   : 6.514   Mean   :15.74   Mean   :3.948  
##  3rd Qu.:2011   3rd Qu.: 9.000   3rd Qu.:23.00   3rd Qu.:6.000  
##  Max.   :2011   Max.   :12.000   Max.   :31.00   Max.   :7.000  
##                                                                 
##     DepTime        ArrTime     UniqueCarrier        FlightNum   
##  Min.   :   1   Min.   :   1   Length:227496      Min.   :   1  
##  1st Qu.:1021   1st Qu.:1215   Class :character   1st Qu.: 855  
##  Median :1416   Median :1617   Mode  :character   Median :1696  
##  Mean   :1396   Mean   :1578                      Mean   :1962  
##  3rd Qu.:1801   3rd Qu.:1953                      3rd Qu.:2755  
##  Max.   :2400   Max.   :2400                      Max.   :7290  
##  NA's   :2905   NA's   :3066                                    
##    TailNum          ActualElapsedTime    AirTime         ArrDelay      
##  Length:227496      Min.   : 34.0     Min.   : 11.0   Min.   :-70.000  
##  Class :character   1st Qu.: 77.0     1st Qu.: 58.0   1st Qu.: -8.000  
##  Mode  :character   Median :128.0     Median :107.0   Median :  0.000  
##                     Mean   :129.3     Mean   :108.1   Mean   :  7.094  
##                     3rd Qu.:165.0     3rd Qu.:141.0   3rd Qu.: 11.000  
##                     Max.   :575.0     Max.   :549.0   Max.   :978.000  
##                     NA's   :3622      NA's   :3622    NA's   :3622     
##     DepDelay          Origin              Dest              Distance     
##  Min.   :-33.000   Length:227496      Length:227496      Min.   :  79.0  
##  1st Qu.: -3.000   Class :character   Class :character   1st Qu.: 376.0  
##  Median :  0.000   Mode  :character   Mode  :character   Median : 809.0  
##  Mean   :  9.445                                         Mean   : 787.8  
##  3rd Qu.:  9.000                                         3rd Qu.:1042.0  
##  Max.   :981.000                                         Max.   :3904.0  
##  NA's   :2905                                                            
##      TaxiIn           TaxiOut         Cancelled       CancellationCode  
##  Min.   :  1.000   Min.   :  1.00   Min.   :0.00000   Length:227496     
##  1st Qu.:  4.000   1st Qu.: 10.00   1st Qu.:0.00000   Class :character  
##  Median :  5.000   Median : 14.00   Median :0.00000   Mode  :character  
##  Mean   :  6.099   Mean   : 15.09   Mean   :0.01307                     
##  3rd Qu.:  7.000   3rd Qu.: 18.00   3rd Qu.:0.00000                     
##  Max.   :165.000   Max.   :163.00   Max.   :1.00000                     
##  NA's   :3066      NA's   :2947                                         
##     Diverted       
##  Min.   :0.000000  
##  1st Qu.:0.000000  
##  Median :0.000000  
##  Mean   :0.002853  
##  3rd Qu.:0.000000  
##  Max.   :1.000000  
##
</code></pre>
<h5 id="convert-dataframe-to-table">Convert <code>data.frame</code> to table<a class="headerlink" href="#convert-dataframe-to-table" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Convert the hflights data.frame into a hflights tbl
hflights &lt;- tbl_df(hflights)

# Display the hflights tbl
hflights
</code></pre>

<pre><code>## # A tibble: 227,496 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
## *  &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1          1         6    1400    1500            AA
## 2   2011     1          2         7    1401    1501            AA
## 3   2011     1          3         1    1352    1502            AA
## 4   2011     1          4         2    1403    1513            AA
## 5   2011     1          5         3    1405    1507            AA
## 6   2011     1          6         4    1359    1503            AA
## 7   2011     1          7         5    1359    1509            AA
## 8   2011     1          8         6    1355    1454            AA
## 9   2011     1          9         7    1443    1554            AA
## 10  2011     1         10         1    1443    1553            AA
## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># Create the object carriers, containing only the UniqueCarrier variable of hflights
carriers &lt;- hflights$UniqueCarrier
</code></pre>

<h5 id="changing-labels-of-hflights">Changing labels of <code>hflights</code><a class="headerlink" href="#changing-labels-of-hflights" title="Permanent link">&para;</a></h5>
<p><strong>part 1 of 2</strong></p>
<pre><code class="r"># add
lut &lt;- c('AA' = 'American', 'AS' = 'Alaska', 'B6' = 'JetBlue', 'CO' = 'Continental', 
         'DL' = 'Delta', 'OO' = 'SkyWest', 'UA' = 'United', 'US' = 'US_Airways', 
         'WN' = 'Southwest', 'EV' = 'Atlantic_Southeast', 'F9' = 'Frontier', 
         'FL' = 'AirTran', 'MQ' = 'American_Eagle', 'XE' = 'ExpressJet', 'YV' = 'Mesa')

# Use lut to translate the UniqueCarrier column of hflights
hflights$UniqueCarrier &lt;- lut[hflights$UniqueCarrier]

# Inspect the resulting raw values of your variables
glimpse(hflights)
</code></pre>

<pre><code>## Observations: 227,496
## Variables: 21
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; "American", "American", "American", "America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; "N576AA", "N557AA", "N541AA", "N403AA", "N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; "IAH", "IAH", "IAH", "IAH", "IAH", "IAH", "I...
## $ Dest              &lt;chr&gt; "DFW", "DFW", "DFW", "DFW", "DFW", "DFW", "D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
</code></pre>
<p><strong>part 2 of 2</strong></p>
<pre><code class="r"># Build the lookup table: lut
lut &lt;- c(&quot;A&quot; = &quot;carrier&quot;, &quot;B&quot; = &quot;weather&quot; ,&quot;C&quot; = &quot;FFA&quot; ,&quot;D&quot; = &quot;security&quot;, &quot;E&quot; = &quot;not cancelled&quot;)

# Add the Code column
hflights$Code &lt;- lut[hflights$CancellationCode]

# Glimpse at hflights
glimpse(hflights)
</code></pre>

<p>Result.</p>
<pre><code class="text">Observations: 227,496
Variables: 22
$ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011,...
$ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
$ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, ...
$ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3,...
$ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359,...
$ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503,...
$ UniqueCarrier     &lt;chr&gt; &quot;American&quot;, &quot;American&quot;, &quot;American&quot;,...
$ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, ...
$ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403...
$ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71,...
$ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41,...
$ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44...
$ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43,...
$ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, ...
$ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, ...
$ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, ...
$ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4...
$ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 1...
$ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;,...
$ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ Code              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA,...
</code></pre>

<h4 id="2-select-and-mutate">2, <code>select</code> and <code>mutate</code><a class="headerlink" href="#2-select-and-mutate" title="Permanent link">&para;</a></h4>
<h5 id="the-five-verbs-and-their-meaning">The five verbs and their meaning<a class="headerlink" href="#the-five-verbs-and-their-meaning" title="Permanent link">&para;</a></h5>
<ul>
<li><code>select</code>; which returns a subset of the columns.</li>
<li><code>filter</code>; that is able to return a subset of the rows.</li>
<li><code>arrange</code>; that reorders the rows according to single or<br />
    multiple variables.</li>
<li><code>mutate</code>; used to add columns from existing data.</li>
<li><code>summarise</code>; which reduces each group to a single row by calculating<br />
    aggregate measures.</li>
</ul>
<h5 id="the-select-verb">The <code>select</code> verb<a class="headerlink" href="#the-select-verb" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Print out a tbl with the four columns of hflights related to delay
select(hflights, ActualElapsedTime, AirTime, ArrDelay, DepDelay)
</code></pre>

<pre><code>## # A tibble: 227,496 × 4
##    ActualElapsedTime AirTime ArrDelay DepDelay
## *              &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1                 60      40      -10        0
## 2                 60      45       -9        1
## 3                 70      48       -8       -8
## 4                 70      39        3        3
## 5                 62      44       -3        5
## 6                 64      45       -7       -1
## 7                 70      43       -1       -1
## 8                 59      40      -16       -5
## 9                 71      41       44       43
## 10                70      45       43       43
## # ... with 227,486 more rows
</code></pre>
<pre><code class="r"># Print out hflights, nothing has changed!
hflights
</code></pre>

<pre><code>## # A tibble: 227,496 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
## *  &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1          1         6    1400    1500      American
## 2   2011     1          2         7    1401    1501      American
## 3   2011     1          3         1    1352    1502      American
## 4   2011     1          4         2    1403    1513      American
## 5   2011     1          5         3    1405    1507      American
## 6   2011     1          6         4    1359    1503      American
## 7   2011     1          7         5    1359    1509      American
## 8   2011     1          8         6    1355    1454      American
## 9   2011     1          9         7    1443    1554      American
## 10  2011     1         10         1    1443    1553      American
## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># Print out the columns Origin up to Cancelled of hflights
select(hflights, 14:19)
</code></pre>

<pre><code>## # A tibble: 227,496 × 6
##    Origin  Dest Distance TaxiIn TaxiOut Cancelled
## *   &lt;chr&gt; &lt;chr&gt;    &lt;int&gt;  &lt;int&gt;   &lt;int&gt;     &lt;int&gt;
## 1     IAH   DFW      224      7      13         0
## 2     IAH   DFW      224      6       9         0
## 3     IAH   DFW      224      5      17         0
## 4     IAH   DFW      224      9      22         0
## 5     IAH   DFW      224      9       9         0
## 6     IAH   DFW      224      6      13         0
## 7     IAH   DFW      224     12      15         0
## 8     IAH   DFW      224      7      12         0
## 9     IAH   DFW      224      8      22         0
## 10    IAH   DFW      224      6      19         0
## # ... with 227,486 more rows
</code></pre>
<pre><code class="r"># Answer to last question: be concise!
select(hflights, 1:4, 12:21)
</code></pre>

<pre><code>## # A tibble: 227,496 × 14
##     Year Month DayofMonth DayOfWeek ArrDelay DepDelay Origin  Dest
## *  &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;    &lt;int&gt;    &lt;int&gt;  &lt;chr&gt; &lt;chr&gt;
## 1   2011     1          1         6      -10        0    IAH   DFW
## 2   2011     1          2         7       -9        1    IAH   DFW
## 3   2011     1          3         1       -8       -8    IAH   DFW
## 4   2011     1          4         2        3        3    IAH   DFW
## 5   2011     1          5         3       -3        5    IAH   DFW
## 6   2011     1          6         4       -7       -1    IAH   DFW
## 7   2011     1          7         5       -1       -1    IAH   DFW
## 8   2011     1          8         6      -16       -5    IAH   DFW
## 9   2011     1          9         7       44       43    IAH   DFW
## 10  2011     1         10         1       43       43    IAH   DFW
## # ... with 227,486 more rows, and 6 more variables: Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<h5 id="helper-functions-for-variable-selection">Helper functions for variable selection<a class="headerlink" href="#helper-functions-for-variable-selection" title="Permanent link">&para;</a></h5>
<p><code>select</code>:</p>
<ul>
<li><code>starts_with("X")</code>; every name that starts with <code>"X"</code>,</li>
<li><code>ends_with("X")</code>; every name that ends with <code>"X"</code>,</li>
<li><code>contains("X")</code>; every name that contains <code>"X"</code>,</li>
<li><code>matches("X")</code>; every name that matches <code>"X"</code>, where <code>"X"</code> can be a<br />
    regular expression,</li>
<li><code>num_range("x", 1:5)</code>; the variables named <code>x01</code>, <code>x02</code>, <code>x03</code>, -<br />
<code>x04</code> and <code>x05</code>,</li>
<li><code>one_of(x)</code>; every name that appears in <code>x</code>, which should be a<br />
    character vector.</li>
</ul>
<!-- -->

<pre><code class="r"># Print out a tbl containing just ArrDelay and DepDelay
select(hflights, ArrDelay, DepDelay)
</code></pre>

<pre><code>## # A tibble: 227,496 × 2
##    ArrDelay DepDelay
## *     &lt;int&gt;    &lt;int&gt;
## 1       -10        0
## 2        -9        1
## 3        -8       -8
## 4         3        3
## 5        -3        5
## 6        -7       -1
## 7        -1       -1
## 8       -16       -5
## 9        44       43
## 10       43       43
## # ... with 227,486 more rows
</code></pre>
<pre><code class="r"># Print out a tbl as described in the second instruction, using both helper functions and variable names
select(hflights, UniqueCarrier, ends_with('Num'), starts_with('Cancel'))
</code></pre>

<pre><code>## # A tibble: 227,496 × 5
##    UniqueCarrier FlightNum TailNum Cancelled CancellationCode
## *          &lt;chr&gt;     &lt;int&gt;   &lt;chr&gt;     &lt;int&gt;            &lt;chr&gt;
## 1       American       428  N576AA         0                 
## 2       American       428  N557AA         0                 
## 3       American       428  N541AA         0                 
## 4       American       428  N403AA         0                 
## 5       American       428  N492AA         0                 
## 6       American       428  N262AA         0                 
## 7       American       428  N493AA         0                 
## 8       American       428  N477AA         0                 
## 9       American       428  N476AA         0                 
## 10      American       428  N504AA         0                 
## # ... with 227,486 more rows
</code></pre>
<pre><code class="r"># Print out a tbl as described in the third instruction, using only helper functions.
select(hflights, ends_with('Time'), ends_with('Delay'))
</code></pre>

<pre><code>## # A tibble: 227,496 × 6
##    DepTime ArrTime ActualElapsedTime AirTime ArrDelay DepDelay
## *    &lt;int&gt;   &lt;int&gt;             &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1     1400    1500                60      40      -10        0
## 2     1401    1501                60      45       -9        1
## 3     1352    1502                70      48       -8       -8
## 4     1403    1513                70      39        3        3
## 5     1405    1507                62      44       -3        5
## 6     1359    1503                64      45       -7       -1
## 7     1359    1509                70      43       -1       -1
## 8     1355    1454                59      40      -16       -5
## 9     1443    1554                71      41       44       43
## 10    1443    1553                70      45       43       43
## # ... with 227,486 more rows
</code></pre>
<h5 id="comparison-to-basic-r">Comparison to basic R<a class="headerlink" href="#comparison-to-basic-r" title="Permanent link">&para;</a></h5>
<pre><code class="r"># add
ex1r &lt;- hflights[c('TaxiIn','TaxiOut','Distance')]

ex1d &lt;- select(hflights, starts_with('Taxi'), Distance)

ex2r &lt;- hflights[c('Year','Month','DayOfWeek','DepTime','ArrTime')]

ex2d &lt;- select(hflights, Year, Month, DayOfWeek, DepTime, ArrTime)

ex3r &lt;- hflights[c('TailNum','TaxiIn','TaxiOut')]

ex3d &lt;- select(hflights, TailNum, starts_with('Taxi'))
</code></pre>

<h5 id="mutate-is-creating"><code>mutate</code> is creating<a class="headerlink" href="#mutate-is-creating" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Add the new variable ActualGroundTime to a copy of hflights and save the result as g1
g1 &lt;- mutate(hflights, ActualGroundTime = ActualElapsedTime - AirTime)
glimpse(hflights)
</code></pre>

<pre><code>## Observations: 227,496
## Variables: 21
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; "American", "American", "American", "America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; "N576AA", "N557AA", "N541AA", "N403AA", "N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; "IAH", "IAH", "IAH", "IAH", "IAH", "IAH", "I...
## $ Dest              &lt;chr&gt; "DFW", "DFW", "DFW", "DFW", "DFW", "DFW", "D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
</code></pre>
<pre><code class="r">glimpse(g1)
</code></pre>

<pre><code>## Observations: 227,496
## Variables: 22
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; "American", "American", "American", "America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; "N576AA", "N557AA", "N541AA", "N403AA", "N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; "IAH", "IAH", "IAH", "IAH", "IAH", "IAH", "I...
## $ Dest              &lt;chr&gt; "DFW", "DFW", "DFW", "DFW", "DFW", "DFW", "D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ ActualGroundTime  &lt;int&gt; 20, 15, 22, 31, 18, 19, 27, 19, 30, 25, 28, ...
</code></pre>
<pre><code class="r"># Add the new variable GroundTime to a g1; save the result as g2
g2 &lt;- mutate(g1, GroundTime = TaxiIn + TaxiOut)

head(g1$ActualGroundTime == g2$GroundTime, 20)
</code></pre>

<pre><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
## [15] TRUE TRUE TRUE TRUE TRUE TRUE
</code></pre>
<pre><code class="r"># Add the new variable AverageSpeed to g2; save the result as g3
g3 &lt;- mutate(g2, AverageSpeed = Distance / AirTime * 60)
g3
</code></pre>

<pre><code>## # A tibble: 227,496 × 24
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1          1         6    1400    1500      American
## 2   2011     1          2         7    1401    1501      American
## 3   2011     1          3         1    1352    1502      American
## 4   2011     1          4         2    1403    1513      American
## 5   2011     1          5         3    1405    1507      American
## 6   2011     1          6         4    1359    1503      American
## 7   2011     1          7         5    1359    1509      American
## 8   2011     1          8         6    1355    1454      American
## 9   2011     1          9         7    1443    1554      American
## 10  2011     1         10         1    1443    1553      American
## # ... with 227,486 more rows, and 17 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;, ActualGroundTime &lt;int&gt;, GroundTime &lt;int&gt;,
## #   AverageSpeed &lt;dbl&gt;
</code></pre>
<h5 id="add-multiple-variables-using-mutate">Add multiple variables using <code>mutate</code><a class="headerlink" href="#add-multiple-variables-using-mutate" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Add a second variable loss_percent to the dataset: m1
m1 &lt;- mutate(hflights, loss = ArrDelay - DepDelay, loss_percent = (ArrDelay - DepDelay)/DepDelay*100)

# Copy and adapt the previous command to reduce redendancy: m2
m2 &lt;- mutate(hflights, loss = ArrDelay - DepDelay, loss_percent = loss/DepDelay * 100)

# Add the three variables as described in the third instruction: m3
m3 &lt;- mutate(hflights, TotalTaxi = TaxiIn + TaxiOut, ActualGroundTime = ActualElapsedTime - AirTime, Diff = TotalTaxi - ActualGroundTime)
glimpse(m3)
</code></pre>

<pre><code>## Observations: 227,496
## Variables: 24
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 20...
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1...
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6,...
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 13...
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 14...
## $ UniqueCarrier     &lt;chr&gt; "American", "American", "American", "America...
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428,...
## $ TailNum           &lt;chr&gt; "N576AA", "N557AA", "N541AA", "N403AA", "N49...
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, ...
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, ...
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29,...
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, ...
## $ Origin            &lt;chr&gt; "IAH", "IAH", "IAH", "IAH", "IAH", "IAH", "I...
## $ Dest              &lt;chr&gt; "DFW", "DFW", "DFW", "DFW", "DFW", "DFW", "D...
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224,...
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6...
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11...
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ CancellationCode  &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", ...
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
## $ TotalTaxi         &lt;int&gt; 20, 15, 22, 31, 18, 19, 27, 19, 30, 25, 28, ...
## $ ActualGroundTime  &lt;int&gt; 20, 15, 22, 31, 18, 19, 27, 19, 30, 25, 28, ...
## $ Diff              &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
</code></pre>
<h4 id="3-filter-and-arrange">3, <code>filter</code> and <code>arrange</code><a class="headerlink" href="#3-filter-and-arrange" title="Permanent link">&para;</a></h4>
<h5 id="logical-operators">Logical operators<a class="headerlink" href="#logical-operators" title="Permanent link">&para;</a></h5>
<p><code>filter</code>:</p>
<ul>
<li><code>x &lt; y</code>; <code>TRUE</code> if <code>x</code> is less than <code>y</code>.</li>
<li><code>x &lt;= y</code>; <code>TRUE</code> if <code>x</code> is less than or equal to <code>y</code>.</li>
<li><code>x == y</code>; <code>TRUE</code> if <code>x</code> equals <code>y</code>.</li>
<li><code>x != y</code>; <code>TRUE</code> if <code>x</code> does not equal <code>y</code>.</li>
<li><code>x &gt;= y</code>; <code>TRUE</code> if <code>x</code> is greater than or equal to <code>y</code>.</li>
<li><code>x &gt; y</code>; <code>TRUE</code> if <code>x</code> is greater than <code>y</code>.</li>
<li><code>x %in% c(a, b, c)</code>; <code>TRUE</code> if <code>x</code> is in the vector <code>c(a, b, c)</code>.</li>
</ul>
<!-- -->

<pre><code class="r"># All flights that traveled 3000 miles or more
filter(hflights, Distance &gt;= 3000)
</code></pre>

<pre><code>## # A tibble: 527 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1         31         1     924    1413   Continental
## 2   2011     1         30         7     925    1410   Continental
## 3   2011     1         29         6    1045    1445   Continental
## 4   2011     1         28         5    1516    1916   Continental
## 5   2011     1         27         4     950    1344   Continental
## 6   2011     1         26         3     944    1350   Continental
## 7   2011     1         25         2     924    1337   Continental
## 8   2011     1         24         1    1144    1605   Continental
## 9   2011     1         23         7     926    1335   Continental
## 10  2011     1         22         6     942    1340   Continental
## # ... with 517 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># All flights flown by one of JetBlue, Southwest, or Delta
filter(hflights, UniqueCarrier %in% c('JetBlue','Southwest','Delta'))
</code></pre>

<pre><code>## # A tibble: 48,679 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1          1         6     654    1124       JetBlue
## 2   2011     1          1         6    1639    2110       JetBlue
## 3   2011     1          2         7     703    1113       JetBlue
## 4   2011     1          2         7    1604    2040       JetBlue
## 5   2011     1          3         1     659    1100       JetBlue
## 6   2011     1          3         1    1801    2200       JetBlue
## 7   2011     1          4         2     654    1103       JetBlue
## 8   2011     1          4         2    1608    2034       JetBlue
## 9   2011     1          5         3     700    1103       JetBlue
## 10  2011     1          5         3    1544    1954       JetBlue
## # ... with 48,669 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># All flights where taxiing took longer than flying
filter(hflights, (TaxiIn + TaxiOut) &gt; AirTime)
</code></pre>

<pre><code>## # A tibble: 1,389 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1         24         1     731     904      American
## 2   2011     1         30         7    1959    2132      American
## 3   2011     1         24         1    1621    1749      American
## 4   2011     1         10         1     941    1113      American
## 5   2011     1         31         1    1301    1356   Continental
## 6   2011     1         31         1    2113    2215   Continental
## 7   2011     1         31         1    1434    1539   Continental
## 8   2011     1         31         1     900    1006   Continental
## 9   2011     1         30         7    1304    1408   Continental
## 10  2011     1         30         7    2004    2128   Continental
## # ... with 1,379 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<h5 id="combining-tests-using-boolean-operators">Combining tests using boolean operators<a class="headerlink" href="#combining-tests-using-boolean-operators" title="Permanent link">&para;</a></h5>
<pre><code class="r"># All flights that departed before 5am or arrived after 10pm
filter(hflights, DepTime &lt; 500 | ArrTime &gt; 2200)
</code></pre>

<pre><code>## # A tibble: 27,799 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1          4         2    2100    2207      American
## 2   2011     1         14         5    2119    2229      American
## 3   2011     1         10         1    1934    2235      American
## 4   2011     1         26         3    1905    2211      American
## 5   2011     1         30         7    1856    2209      American
## 6   2011     1          9         7    1938    2228        Alaska
## 7   2011     1         31         1    1919    2231   Continental
## 8   2011     1         31         1    2116    2344   Continental
## 9   2011     1         31         1    1850    2211   Continental
## 10  2011     1         31         1    2102    2216   Continental
## # ... with 27,789 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># All flights that departed late but arrived ahead of schedule
filter(hflights, DepDelay &gt; 0 &amp; ArrDelay &lt; 0)
</code></pre>

<pre><code>## # A tibble: 27,712 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1          2         7    1401    1501      American
## 2   2011     1          5         3    1405    1507      American
## 3   2011     1         18         2    1408    1508      American
## 4   2011     1         18         2     721     827      American
## 5   2011     1         12         3    2015    2113      American
## 6   2011     1         13         4    2020    2116      American
## 7   2011     1         26         3    2009    2103      American
## 8   2011     1          1         6    1631    1736      American
## 9   2011     1         10         1    1639    1740      American
## 10  2011     1         12         3    1631    1739      American
## # ... with 27,702 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># All cancelled weekend flights
filter(hflights, DayOfWeek %in% c(6,7) &amp; Cancelled == 1)
</code></pre>

<pre><code>## # A tibble: 585 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime      UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;              &lt;chr&gt;
## 1   2011     1          9         7      NA      NA           American
## 2   2011     1         29         6      NA      NA        Continental
## 3   2011     1          9         7      NA      NA        Continental
## 4   2011     1          9         7      NA      NA              Delta
## 5   2011     1          9         7      NA      NA            SkyWest
## 6   2011     1          2         7      NA      NA          Southwest
## 7   2011     1         29         6      NA      NA              Delta
## 8   2011     1          9         7      NA      NA Atlantic_Southeast
## 9   2011     1          1         6      NA      NA            AirTran
## 10  2011     1          9         7      NA      NA            AirTran
## # ... with 575 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># All flights that were cancelled after being delayed
filter(hflights, DepDelay &gt; 0 &amp; Cancelled == 1)
</code></pre>

<pre><code>## # A tibble: 40 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     1         26         3    1926      NA   Continental
## 2   2011     1         11         2    1100      NA    US_Airways
## 3   2011     1         19         3    1811      NA    ExpressJet
## 4   2011     1          7         5    2028      NA    ExpressJet
## 5   2011     2          4         5    1638      NA      American
## 6   2011     2          8         2    1057      NA   Continental
## 7   2011     2          2         3     802      NA    ExpressJet
## 8   2011     2          9         3     904      NA    ExpressJet
## 9   2011     2          1         2    1508      NA       SkyWest
## 10  2011     3         31         4    1016      NA   Continental
## # ... with 30 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<h5 id="blend-together">Blend together<a class="headerlink" href="#blend-together" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Select the flights that had JFK as their destination: c1
c1 &lt;- filter(hflights, Dest == 'JFK')

# Combine the Year, Month and DayofMonth variables to create a Date column: c2
c2 &lt;- mutate(c1, Date = paste(Year, Month, DayofMonth, sep = '-'))

# Print out a selection of columns of c2
select(c2, Date, DepTime, ArrTime, TailNum)
</code></pre>

<pre><code>## # A tibble: 695 × 4
##        Date DepTime ArrTime TailNum
##       &lt;chr&gt;   &lt;int&gt;   &lt;int&gt;   &lt;chr&gt;
## 1  2011-1-1     654    1124  N324JB
## 2  2011-1-1    1639    2110  N324JB
## 3  2011-1-2     703    1113  N324JB
## 4  2011-1-2    1604    2040  N324JB
## 5  2011-1-3     659    1100  N229JB
## 6  2011-1-3    1801    2200  N206JB
## 7  2011-1-4     654    1103  N267JB
## 8  2011-1-4    1608    2034  N267JB
## 9  2011-1-5     700    1103  N708JB
## 10 2011-1-5    1544    1954  N644JB
## # ... with 685 more rows
</code></pre>
<h5 id="arranging-your-data">Arranging your data<a class="headerlink" href="#arranging-your-data" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Definition of dtc
dtc &lt;- filter(hflights, Cancelled == 1, !is.na(DepDelay))

# Arrange dtc by departure delays
arrange(dtc, DepDelay)
</code></pre>

<pre><code>## # A tibble: 68 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime  UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;          &lt;chr&gt;
## 1   2011     7         23         6     605      NA       Frontier
## 2   2011     1         17         1     916      NA     ExpressJet
## 3   2011    12          1         4     541      NA     US_Airways
## 4   2011    10         12         3    2022      NA American_Eagle
## 5   2011     7         29         5    1424      NA    Continental
## 6   2011     9         29         4    1639      NA        SkyWest
## 7   2011     2          9         3     555      NA American_Eagle
## 8   2011     5          9         1     715      NA        SkyWest
## 9   2011     1         20         4    1413      NA         United
## 10  2011     1         17         1     831      NA      Southwest
## # ... with 58 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># Arrange dtc so that cancellation reasons are grouped
arrange(dtc, CancellationCode)
</code></pre>

<pre><code>## # A tibble: 68 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime  UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;          &lt;chr&gt;
## 1   2011     1         20         4    1413      NA         United
## 2   2011     1          7         5    2028      NA     ExpressJet
## 3   2011     2          4         5    1638      NA       American
## 4   2011     2          8         2    1057      NA    Continental
## 5   2011     2          1         2    1508      NA        SkyWest
## 6   2011     2         21         1    2257      NA        SkyWest
## 7   2011     2          9         3     555      NA American_Eagle
## 8   2011     3         18         5     727      NA         United
## 9   2011     4          4         1    1632      NA          Delta
## 10  2011     4          8         5    1608      NA      Southwest
## # ... with 58 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># Arrange dtc according to carrier and departure delays
arrange(dtc, UniqueCarrier, DepDelay)
</code></pre>

<pre><code>## # A tibble: 68 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime      UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;              &lt;chr&gt;
## 1   2011     6         11         6    1649      NA            AirTran
## 2   2011     8         18         4    1808      NA           American
## 3   2011     2          4         5    1638      NA           American
## 4   2011    10         12         3    2022      NA     American_Eagle
## 5   2011     2          9         3     555      NA     American_Eagle
## 6   2011     7         17         7    1917      NA     American_Eagle
## 7   2011     4         30         6     612      NA Atlantic_Southeast
## 8   2011     4         10         7    1147      NA Atlantic_Southeast
## 9   2011     5         23         1     657      NA Atlantic_Southeast
## 10  2011     9         29         4     723      NA Atlantic_Southeast
## # ... with 58 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<h5 id="reverse-the-order-of-arranging">Reverse the order of arranging<a class="headerlink" href="#reverse-the-order-of-arranging" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Arrange according to carrier and decreasing departure delays
arrange(hflights, UniqueCarrier, desc(DepDelay))
</code></pre>

<pre><code>## # A tibble: 227,496 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     2         19         6    1902    2143       AirTran
## 2   2011     3         14         1    2024    2309       AirTran
## 3   2011     2         16         3    2349     227       AirTran
## 4   2011    11         13         7    2312     213       AirTran
## 5   2011     5         26         4    2353     305       AirTran
## 6   2011     5         26         4    1922    2229       AirTran
## 7   2011     4         28         4    1045    1328       AirTran
## 8   2011     6          5         7    2207      52       AirTran
## 9   2011     5          7         6    1009    1256       AirTran
## 10  2011     7         25         1    2107      14       AirTran
## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># Arrange flights by total delay (normal order).
arrange(hflights, (ArrDelay+DepDelay))
</code></pre>

<pre><code>## # A tibble: 227,496 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;         &lt;chr&gt;
## 1   2011     7          3         7    1914    2039    ExpressJet
## 2   2011     8         31         3     934    1039       SkyWest
## 3   2011     8         21         7     935    1039       SkyWest
## 4   2011     8         28         7    2059    2206       SkyWest
## 5   2011     8         29         1     935    1041       SkyWest
## 6   2011    12         25         7     741     926       SkyWest
## 7   2011     1         30         7     620     812       SkyWest
## 8   2011     8          3         3    1741    1810    ExpressJet
## 9   2011     8          4         4     930    1041       SkyWest
## 10  2011     8         18         4     939    1043       SkyWest
## # ... with 227,486 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<pre><code class="r"># Keep flights leaving to DFW before 8am and arrange according to decreasing AirTime 
arrange(filter(hflights, Dest == 'DFW' &amp; DepTime&lt;800), desc(AirTime))
</code></pre>

<pre><code>## # A tibble: 799 × 21
##     Year Month DayofMonth DayOfWeek DepTime ArrTime  UniqueCarrier
##    &lt;int&gt; &lt;int&gt;      &lt;int&gt;     &lt;int&gt;   &lt;int&gt;   &lt;int&gt;          &lt;chr&gt;
## 1   2011    11         22         2     635     825       American
## 2   2011     8         25         4     602     758 American_Eagle
## 3   2011    10         12         3     559     738 American_Eagle
## 4   2011     5          2         1     716     854       American
## 5   2011     4          4         1     741     949       American
## 6   2011     4          4         1     627     742 American_Eagle
## 7   2011     6         21         2     726     848     ExpressJet
## 8   2011     9          1         4     715     844       American
## 9   2011     3         14         1     729     917    Continental
## 10  2011    12          5         1     724     847    Continental
## # ... with 789 more rows, and 14 more variables: FlightNum &lt;int&gt;,
## #   TailNum &lt;chr&gt;, ActualElapsedTime &lt;int&gt;, AirTime &lt;int&gt;, ArrDelay &lt;int&gt;,
## #   DepDelay &lt;int&gt;, Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;,
## #   TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;, Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;,
## #   Diverted &lt;int&gt;
</code></pre>
<h4 id="4-summarise-and-the-pipe-operator">4, <code>summarise</code> and the Pipe Operator<a class="headerlink" href="#4-summarise-and-the-pipe-operator" title="Permanent link">&para;</a></h4>
<h5 id="the-syntax-of-summarise">The syntax of <code>summarise</code><a class="headerlink" href="#the-syntax-of-summarise" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Print out a summary with variables min_dist and max_dist
summarise(hflights, min_dist = min(Distance), max_dist = max(Distance))
</code></pre>

<pre><code>## # A tibble: 1 × 2
##   min_dist max_dist
##      &lt;int&gt;    &lt;int&gt;
## 1       79     3904
</code></pre>
<pre><code class="r"># Print out a summary with variable max_div
summarise(filter(hflights, Diverted == 1), max_div = max(Distance))
</code></pre>

<pre><code>## # A tibble: 1 × 1
##   max_div
##     &lt;int&gt;
## 1    3904
</code></pre>
<h5 id="aggregate-functions">Aggregate functions<a class="headerlink" href="#aggregate-functions" title="Permanent link">&para;</a></h5>
<p><code>summarise</code>:</p>
<ul>
<li><code>min(x)</code>; minimum value of vector x.</li>
<li><code>max(x)</code>; maximum value of vector x.</li>
<li><code>mean(x)</code>; mean value of vector x.</li>
<li><code>median(x)</code>; median value of vector x.</li>
<li><code>quantile(x, p)</code>; pth quantile of vector x.</li>
<li><code>sd(x)</code>; standard deviation of vector x.</li>
<li><code>var(x)</code>; variance of vector x.</li>
<li><code>IQR(x)</code>; Inter Quartile Range (IQR) of vector x.</li>
<li><code>diff(range(x))</code>; total range of vector x.</li>
</ul>
<!-- -->

<pre><code class="r"># Remove rows that have NA ArrDelay: temp1
temp1 &lt;- filter(hflights, !is.na(ArrDelay))

# Generate summary about ArrDelay column of temp1
summarise(temp1, earliest = min(ArrDelay), average = mean(ArrDelay), latest = max(ArrDelay), sd = sd(ArrDelay))
</code></pre>

<pre><code>## # A tibble: 1 × 4
##   earliest  average latest       sd
##      &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt;
## 1      -70 7.094334    978 30.70852
</code></pre>
<pre><code class="r"># Keep rows that have no NA TaxiIn and no NA TaxiOut: temp2
temp2 &lt;- filter(hflights, !is.na(TaxiIn), !is.na(TaxiOut))

# Print the maximum taxiing difference of temp2 with summarise()
summarise(temp2, max_taxi_diff = max(abs(TaxiIn - TaxiOut)))
</code></pre>

<pre><code>## # A tibble: 1 × 1
##   max_taxi_diff
##           &lt;int&gt;
## 1           160
</code></pre>
<h5 id="dplyr-aggregate-functions"><code>dplyr</code> aggregate functions<a class="headerlink" href="#dplyr-aggregate-functions" title="Permanent link">&para;</a></h5>
<ul>
<li><code>first(x)</code>; the first element of vector <code>x</code>.</li>
<li><code>last(x)</code>; the last element of vector <code>x</code>.</li>
<li><code>nth(x, n)</code>; The <code>n</code>th element of vector <code>x</code>.</li>
<li><code>n()</code>; The number of rows in the data.frame or group of observations<br />
    that <code>summarise()</code> describes.</li>
<li><code>n_distinct(x)</code>; The number of unique values in vector <code>x</code>.</li>
</ul>
<!-- -->

<pre><code class="r"># Generate summarizing statistics for hflights
summarise(hflights, n_obs = n(), n_carrier = n_distinct(UniqueCarrier), n_dest = n_distinct(Dest), dest100 = nth(Dest, 100))
</code></pre>

<pre><code>## # A tibble: 1 × 4
##    n_obs n_carrier n_dest dest100
##    &lt;int&gt;     &lt;int&gt;  &lt;int&gt;   &lt;chr&gt;
## 1 227496        15    116     DFW
</code></pre>
<pre><code class="r"># Filter hflights to keep all American Airline flights: aa
aa &lt;- filter(hflights, UniqueCarrier == 'American')

# Generate summarizing statistics for aa 
summarise(aa, n_flights = n(), n_canc = sum(Cancelled), p_canc = n_canc/n_flights*100, avg_delay = mean(ArrDelay, na.rm = TRUE))
</code></pre>

<pre><code>## # A tibble: 1 × 4
##   n_flights n_canc   p_canc avg_delay
##       &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1      3244     60 1.849568 0.8917558
</code></pre>
<p><strong>Overview of syntax</strong></p>
<pre><code class="r"># Write the 'piped' version of the English sentences
hflights %&gt;%
    mutate(diff = TaxiOut - TaxiIn) %&gt;%
    filter(!is.na(diff)) %&gt;%
    summarise( avg = mean(diff))
</code></pre>

<pre><code>## # A tibble: 1 × 1
##        avg
##      &lt;dbl&gt;
## 1 8.992064
</code></pre>
<p><strong>Drive or fly? Part 1 of 2</strong></p>
<pre><code class="r"># Part 1, concerning the selection and creation of columns
d &lt;- hflights %&gt;%
  select(Dest, UniqueCarrier, Distance, ActualElapsedTime) %&gt;%  
  mutate(RealTime = ActualElapsedTime + 100, mph = Distance / RealTime * 60)

# Part 2, concerning flights that had an actual average speed of &lt; 70 mph.
d %&gt;%
  filter(!is.na(mph), mph &lt; 70) %&gt;%
  summarise( n_less = n(), 
             n_dest = n_distinct(Dest), 
             min_dist = min(Distance), 
             max_dist = max(Distance))
</code></pre>

<pre><code>## # A tibble: 1 × 4
##   n_less n_dest min_dist max_dist
##    &lt;int&gt;  &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1   6726     13       79      305
</code></pre>
<p><strong>Drive or fly? Part 2 of 2</strong></p>
<pre><code class="r"># Solve the exercise using a combination of dplyr verbs and %&gt;%
hflights %&gt;%
    #summarise(all_flights = n()) %&gt;%
    filter(((Distance / (ActualElapsedTime + 100) * 60) &lt; 105) | Cancelled == 1 | Diverted == 1) %&gt;%
    summarise(n_non = n(), p_non = n_non / 22751 *100, n_dest = n_distinct(Dest), min_dist = min(Distance), max_dist = max(Distance))
</code></pre>

<pre><code>## # A tibble: 1 × 5
##   n_non    p_non n_dest min_dist max_dist
##   &lt;int&gt;    &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1 42400 186.3654    113       79     3904
</code></pre>
<p><strong>Advanced piping exercise</strong></p>
<pre><code class="r"># Count the number of overnight flights
hflights %&gt;%
    filter(ArrTime &lt; DepTime &amp; !is.na(DepTime) &amp; !is.na(ArrTime)) %&gt;%
    summarise(n = n())
</code></pre>

<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  2718
</code></pre>
<h4 id="5-group_by-and-working-with-data">5, <code>group_by</code> and working with data<a class="headerlink" href="#5-group_by-and-working-with-data" title="Permanent link">&para;</a></h4>
<h5 id="unite-and-conquer-using-group_by">Unite and conquer using <code>group_by</code><a class="headerlink" href="#unite-and-conquer-using-group_by" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Make an ordered per-carrier summary of hflights
hflights %&gt;%
   group_by(UniqueCarrier) %&gt;%
   summarise(n_flights = n(), 
             n_canc = sum(Cancelled == 1), 
             p_canc = mean(Cancelled == 1) * 100, 
             avg_delay = mean(ArrDelay, na.rm = TRUE)) %&gt;%
   arrange(avg_delay, p_canc)
</code></pre>

<pre><code>## # A tibble: 15 × 5
##         UniqueCarrier n_flights n_canc    p_canc  avg_delay
##                 &lt;chr&gt;     &lt;int&gt;  &lt;int&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1          US_Airways      4082     46 1.1268986 -0.6307692
## 2            American      3244     60 1.8495684  0.8917558
## 3             AirTran      2139     21 0.9817672  1.8536239
## 4              Alaska       365      0 0.0000000  3.1923077
## 5                Mesa        79      1 1.2658228  4.0128205
## 6               Delta      2641     42 1.5903067  6.0841374
## 7         Continental     70032    475 0.6782614  6.0986983
## 8      American_Eagle      4648    135 2.9044750  7.1529751
## 9  Atlantic_Southeast      2204     76 3.4482759  7.2569543
## 10          Southwest     45343    703 1.5504047  7.5871430
## 11           Frontier       838      6 0.7159905  7.6682692
## 12         ExpressJet     73053   1132 1.5495599  8.1865242
## 13            SkyWest     16061    224 1.3946828  8.6934922
## 14            JetBlue       695     18 2.5899281  9.8588410
## 15             United      2072     34 1.6409266 10.4628628
</code></pre>
<pre><code class="r"># Make an ordered per-day summary of hflights
hflights %&gt;% 
   group_by(DayOfWeek) %&gt;%
   summarise(avg_taxi = mean(TaxiIn + TaxiOut, na.rm=TRUE)) %&gt;%
   arrange(desc(avg_taxi))
</code></pre>

<pre><code>## # A tibble: 7 × 2
##   DayOfWeek avg_taxi
##       &lt;int&gt;    &lt;dbl&gt;
## 1         1 21.77027
## 2         2 21.43505
## 3         4 21.26076
## 4         3 21.19055
## 5         5 21.15805
## 6         7 20.93726
## 7         6 20.43061
</code></pre>
<h5 id="combine-group_by-with-mutate">Combine <code>group_by</code> with <code>mutate</code><a class="headerlink" href="#combine-group_by-with-mutate" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Solution to first instruction
hflights %&gt;%
    filter(!is.na(ArrDelay)) %&gt;%
    group_by(UniqueCarrier) %&gt;%
    summarise(p_delay = sum(ArrDelay &gt; 0) / n()) %&gt;%
    mutate(rank = rank(p_delay)) %&gt;%
    arrange(rank)
</code></pre>

<pre><code>## # A tibble: 15 × 3
##         UniqueCarrier   p_delay  rank
##                 &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1            American 0.3030208     1
## 2             AirTran 0.3112269     2
## 3          US_Airways 0.3267990     3
## 4  Atlantic_Southeast 0.3677511     4
## 5      American_Eagle 0.3696714     5
## 6               Delta 0.3871092     6
## 7             JetBlue 0.3952452     7
## 8              Alaska 0.4368132     8
## 9           Southwest 0.4644557     9
## 10               Mesa 0.4743590    10
## 11        Continental 0.4907385    11
## 12         ExpressJet 0.4943420    12
## 13             United 0.4963109    13
## 14            SkyWest 0.5350105    14
## 15           Frontier 0.5564904    15
</code></pre>
<pre><code class="r"># Solution to second instruction
hflights %&gt;%
    filter(!is.na(ArrDelay), ArrDelay &gt; 0) %&gt;%
    group_by(UniqueCarrier) %&gt;%
    summarise(avg = mean(ArrDelay)) %&gt;%
    mutate(rank = rank(avg)) %&gt;%
    arrange(rank)
</code></pre>

<pre><code>## # A tibble: 15 × 3
##         UniqueCarrier      avg  rank
##                 &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1                Mesa 18.67568     1
## 2            Frontier 18.68683     2
## 3          US_Airways 20.70235     3
## 4         Continental 22.13374     4
## 5              Alaska 22.91195     5
## 6             SkyWest 24.14663     6
## 7          ExpressJet 24.19337     7
## 8           Southwest 25.27750     8
## 9             AirTran 27.85693     9
## 10           American 28.49740    10
## 11              Delta 32.12463    11
## 12             United 32.48067    12
## 13     American_Eagle 38.75135    13
## 14 Atlantic_Southeast 40.24231    14
## 15            JetBlue 45.47744    15
</code></pre>
<h5 id="advanced-group_by">Advanced <code>group_by</code><a class="headerlink" href="#advanced-group_by" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Which plane (by tail number) flew out of Houston the most times? How many times? adv1
adv1 &lt;- hflights %&gt;%
          group_by(TailNum) %&gt;%
          summarise(n = n()) %&gt;%
          filter(n == max(n))

# How many airplanes only flew to one destination from Houston? adv2
adv2 &lt;- hflights %&gt;%
          group_by(TailNum) %&gt;%
          summarise(ndest = n_distinct(Dest)) %&gt;%
          filter(ndest == 1) %&gt;%
          summarise(nplanes = n())

# Find the most visited destination for each carrier: adv3
adv3 &lt;- hflights %&gt;% 
          group_by(UniqueCarrier, Dest) %&gt;%
          summarise(n = n()) %&gt;%
          mutate(rank = rank(desc(n))) %&gt;%
          filter(rank == 1)

# Find the carrier that travels to each destination the most: adv4
adv4 &lt;- hflights %&gt;% 
          group_by(Dest, UniqueCarrier) %&gt;%
          summarise(n = n()) %&gt;%
          mutate(rank = rank(desc(n))) %&gt;%
          filter(rank == 1)
</code></pre>

<h5 id="dplyr-deals-with-different-types"><code>dplyr</code> deals with different types<a class="headerlink" href="#dplyr-deals-with-different-types" title="Permanent link">&para;</a></h5>
<pre><code class="r"># Use summarise to calculate n_carrier
s2 &lt;- hflights %&gt;%
    summarise(n_carrier = n_distinct(UniqueCarrier))
</code></pre>

<h5 id="dplyr-and-mysql-databases"><code>dplyr</code> and mySQL databases<a class="headerlink" href="#dplyr-and-mysql-databases" title="Permanent link">&para;</a></h5>
<p>Code only.</p>
<pre><code class="r"># set up a src that connects to the mysql database (src_mysql is provided by dplyr)
my_db &lt;- src_mysql(dbname = 'dplyr', 
                  host = 'dplyr.csrrinzqubik.us-east-1.rds.amazonaws.com', 
                  port = 3306,
                  user = 'dplyr',
                  password = 'dplyr')

# and reference a table within that src: nycflights is now available as an R object that references to the remote nycflights table
nycflights &lt;- tbl(my_db, 'dplyr')

# glimpse at nycflights
glimpse(nycflights)

# Calculate the grouped summaries detailed in the instructions
nycflights %&gt;%
   group_by(carrier) %&gt;%
   summarise(n_flights = n(), avg_delay = mean(arr_delay)) %&gt;%
   arrange(avg_delay)
</code></pre>

<h4 id="adding-tidyr-functions">Adding <code>tidyr</code> Functions<a class="headerlink" href="#adding-tidyr-functions" title="Permanent link">&para;</a></h4>
<ul>
<li><code>complete</code>.</li>
<li><code>drop_na</code>.</li>
<li><code>expand</code>.</li>
<li><code>extract</code>.</li>
<li><code>extract_numeric</code>.</li>
<li><code>complete</code>.</li>
<li><code>fill</code>.</li>
<li><code>full_seq</code>.</li>
<li><code>gather</code>.</li>
<li><code>nest</code>.</li>
<li><code>replace_na</code>.</li>
<li><code>separate</code>.</li>
<li><code>separate_rows</code>.</li>
<li><code>separate_rows_</code>.</li>
<li><code>smiths</code>.</li>
<li><code>spread</code>.</li>
<li><code>table1</code>.</li>
<li><code>unite</code>.</li>
<li><code>unnest</code>.</li>
<li><code>who</code>.</li>
</ul>
<hr />
<h4 id="joining-data-in-r-with-dplyr">Joining Data in R with <code>dplyr</code><a class="headerlink" href="#joining-data-in-r-with-dplyr" title="Permanent link">&para;</a></h4>
<p><em>In development</em></p>
<pre><code class="text">## 1, Mutating Joins

## 2, Filtering Joins and Set Operations

## 3, Assembling Data

## 4, Advanced Joining

## 5, Case Study
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Plot_snippets_-_Basics/" class="btn btn-neutral float-right" title="Plot Snippets for Exploratory (and some Explanatory) Analyses">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Data_Analysis_in_R,_the_data.table_Way/" class="btn btn-neutral" title="Data Analysis in R, the data.table Way"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>© Ugo Sparks</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Data_Analysis_in_R,_the_data.table_Way/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Plot_snippets_-_Basics/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../mathjaxhelper.js"></script>

</body>
</html>
